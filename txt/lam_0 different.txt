

> ## show how values of lam_0 were computed
> uniroot(function(x) tbdx(lam_0=x)$lam[10001]-0.02, c(1e-5, 2e-4), trace=2, tol=1e-10)
$root
[1] 0.0001483185

$f.root
[1] 3.447936e-14

$iter
[1] 5

$init.it
[1] NA

$estim.prec
[1] 9.310233e-11



> x <- tbdx()
> do.call("cbind", x)[c(1:6, 9996:10001), ]
       times    S_neg    L_neg  DSP_neg  USP_neg  DSN_neg  USN_neg    S_hiv    L_hiv  DSP_hiv  USP_hiv
 [1,]   0.00 48195.00 34421.00 13.00000 33.00000 57.00000 103.0000 6762.000 5799.000 2.000000 3.000000
 [2,]   0.02 48195.57 34423.71 13.02664 33.02291 57.06352 103.0247 6761.720 5797.585 2.516010 3.168689
 [3,]   0.04 48196.14 34426.34 13.05012 33.04507 57.12412 103.0485 6761.450 5796.206 2.987307 3.331611
 [4,]   0.06 48196.70 34428.90 13.07069 33.06651 57.18191 103.0717 6761.190 5794.860 3.417745 3.488961
 [5,]   0.08 48197.27 34431.39 13.08857 33.08724 57.23698 103.0941 6760.939 5793.546 3.810844 3.640931
 [6,]   0.10 48197.83 34433.81 13.10396 33.10730 57.28945 103.1159 6760.696 5792.260 4.169821 3.787703
 [7,] 199.90 48403.20 34569.25 12.60111 33.54057 57.08194 103.6486 6790.056 5574.882 7.638423 7.714495
 [8,] 199.92 48403.20 34569.25 12.60111 33.54057 57.08194 103.6486 6790.056 5574.882 7.638423 7.714495
 [9,] 199.94 48403.20 34569.25 12.60111 33.54057 57.08194 103.6486 6790.056 5574.882 7.638423 7.714495
[10,] 199.96 48403.20 34569.25 12.60111 33.54057 57.08194 103.6486 6790.056 5574.882 7.638423 7.714495
[11,] 199.98 48403.20 34569.25 12.60111 33.54057 57.08194 103.6486 6790.056 5574.882 7.638423 7.714495
[12,] 200.00 48403.20 34569.25 12.60111 33.54057 57.08194 103.6486 6790.056 5574.882 7.638423 7.714495
        DSN_hiv   USN_hiv   S_aids   L_aids DSP_aids USP_aids DSN_aids USN_aids        lam      TSP      TSN
 [1,]  6.000000  6.000000 2446.000 2014.000 15.00000 22.00000 63.00000 40.00000 0.02202530 88.00000 275.0000
 [2,]  6.590016  6.171946 2445.905 2014.012 14.67825 21.50325 61.61867 39.11347 0.02196654 87.91574 273.5823
 [3,]  7.152124  6.337985 2445.813 2013.985 14.38726 21.02689 60.31198 38.26296 0.02190969 87.82826 272.2377
 [4,]  7.687636  6.498322 2445.723 2013.922 14.12405 20.57009 59.07583 37.44699 0.02185470 87.73805 270.9624
 [5,]  8.197802  6.653149 2445.636 2013.825 13.88592 20.13205 57.90638 36.66415 0.02180150 87.64555 269.7526
 [6,]  8.683813  6.802657 2445.552 2013.696 13.67043 19.71198 56.79999 35.91307 0.02175006 87.55120 268.6049
 [7,] 17.849171 10.739203 2456.656 1882.696 10.84299  9.36572 35.09674 17.13716 0.02000000 81.70331 241.5529
 [8,] 17.849171 10.739203 2456.656 1882.696 10.84299  9.36572 35.09674 17.13716 0.02000000 81.70331 241.5529
 [9,] 17.849171 10.739203 2456.656 1882.696 10.84299  9.36572 35.09674 17.13716 0.02000000 81.70331 241.5529
[10,] 17.849171 10.739203 2456.656 1882.696 10.84299  9.36572 35.09674 17.13716 0.02000000 81.70331 241.5529
[11,] 17.849171 10.739203 2456.656 1882.696 10.84299  9.36572 35.09674 17.13716 0.02000000 81.70331 241.5529
[12,] 17.849171 10.739203 2456.656 1882.696 10.84299  9.36572 35.09674 17.13716 0.02000000 81.70331 241.5529
             M incid_tb  prev_tb  mort_tb
 [1,] 6211.623 434.2487 363.0000 337.6000
 [2,] 6207.552 433.8279 361.4980 333.6234
 [3,] 6203.665 433.4171 360.0660 329.8423
 [4,] 6199.953 433.0164 358.7004 326.2463
 [5,] 6196.408 432.6254 357.3982 322.8257
 [6,] 6193.020 432.2441 356.1561 319.5714
 [7,] 6066.803 405.9945 323.2562 243.0198
 [8,] 6066.803 405.9945 323.2562 243.0198
 [9,] 6066.803 405.9945 323.2562 243.0198
[10,] 6066.803 405.9945 323.2562 243.0198
[11,] 6066.803 405.9945 323.2562 243.0198
[12,] 6066.803 405.9945 323.2562 243.0198